<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<title>Zipdev</title>
		<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet" type="text/css">
		<link href="css/style.css" rel="stylesheet" type="text/css">
		<script src="https://kit.fontawesome.com/84f4d44bd3.js" crossorigin="anonymous"></script>
	</head>
	<body>
		
		<div class="container" id="quiz">
			<div class="progress-container">
				<div class="progress">
					  <div id="progress" class="progress-bar" role="progressbar" style="width: 1%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
				</div>
			</div>
			
			<br><br>
			<h1>Quiz Time !</h1>			
			<form>
				<div class="form-row">
					<div class="form-group col-md-12">
						<label for="question_one">How do you describe yourself as a developer?</label>
						<input type="text" class="form-control" id="question_one" placeholder="">
					</div>
					<div class="form-group col-md-12">
						<label for="question_two">Select the Javascript based Technologies</label>
						<br>
						<div class="form-check form-check-inline">
							<input class="form-check-input" type="checkbox" id="tech1" value="AngujarJS">
							<label class="form-check-label" for="tech1">AngularJS</label>
						</div>
						<div class="form-check form-check-inline">
							<input class="form-check-input" type="checkbox" id="tech2" value="Ember">
							<label class="form-check-label" for="tech2">Ember</label>
						</div>
						<div class="form-check form-check-inline">
							<input class="form-check-input" type="checkbox" id="tech3" value="VueJS">
							<label class="form-check-label" for="tech3">VueJS</label>
						</div>
						<div class="form-check form-check-inline">
							<input class="form-check-input" type="checkbox" id="tech4" value="Java">
							<label class="form-check-label" for="tech4">Java</label>
						</div>
						<div class="form-check form-check-inline">
							<input class="form-check-input" type="checkbox" id="tech5" value="C#">
							<label class="form-check-label" for="tech5">C#</label>
						</div>										
					</div>
					
					<div class="form-group col-md-12">
						<label for="question_three">Introduce a Palindrome</label>
						<input type="text" class="form-control" id="question_three" placeholder="">
					</div>
					
					<h3>Introduce a sentence and then the sentence in reverse</h3>
					<br>
					<div class="form-group col-md-6">
						<label for="question_fourth">Sentence</label>
						<input type="text" class="form-control" id="question_fourth" placeholder="">
					</div>					

					<div class="form-group col-md-6">
						<label for="question_five">Sentence in reverse</label>
						<input type="text" class="form-control" id="question_five" placeholder="">
					</div>										
					
				</div>	

			</form>					
			<button class="btn btn-primary" id="finish_btn">Finish</button>
				
		</div>		
		<div class="container" id="results">
			<h1>Results</h1>
			<div class="row">
				<div class="col-md-12">
					<h4>How do you describe yourself as a developer?</h4>
					<p id="result1">Result1</p>
				</div>
				
				<div class="col-md-12">
					<h4>Javascript based Technologies</h4>
					<p id="tech1_answer">AngularJS </p>
					<p id="tech2_answer">Ember</p>
					<p id="tech3_answer">VueJS</p>
					<p id="tech4_answer">Java</p>					
					<p id="tech5_answer">C#</p>
				</div>
				
				<div class="col-md-12">
					<h4>Palindrome</h4>
					<p id="result3">Result1</p>
				</div>
				
				<div class="col-md-12">
					<h4>Sentence</h4>
					<div class="row">
						<div class="col-md-6">
							<p id="result4"></p>
						</div>
						<div class="col-md-6">	
							<p id="result5"></p>
						</div>						
					</div>
					<p id="sentence_result" >Sentence result</p>					
				</div>												
			</div>

		</div>
		
		<div id="restaurants">
			<br>
			<h1>Please don't forget to visit San Diego Restaurants</h1>
			<br>
		</div>	
				
	</body>
	
	<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>	
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>	


	<script>
		
		$("#results").hide();
		$("#restaurants").hide();		


		var q_one_progress = 0;
		var q_two_progress = 0;
		var q_three_progress = 0;
		var q_four_progress = 0;
		var q_five_progress = 0;
		
		var total_progress = 1;

		$("#question_one").change(function(){
			
			if($("#question_one").val() != ""){
				q_one_progress = 20; 	
			}else{
				q_one_progress = 0; 	
			}
			
		});
		
		$("#question_three").change(function(){
			
			if($("#question_three").val() != ""){
				q_three_progress = 20; 	
			}else{
				q_three_progress = 0; 	
			}
			
		});

		$("#question_fourth").change(function(){
			
			if($("#question_fourth").val() != ""){
				q_four_progress = 25; 	
			}else{
				q_four_progress = 0; 	
			}
			
		});
		
		$("#question_five").change(function(){
			
			if($("#question_five").val() != ""){
				q_five_progress = 20; 	
			}else{
				q_five_progress = 0; 	
			}
			
		});		
		
		
		setInterval(function(){

			if(
				(document.getElementById('tech1').checked == true )||
				(document.getElementById('tech2').checked == true )||
				(document.getElementById('tech3').checked == true )||
				(document.getElementById('tech4').checked == true )||
				(document.getElementById('tech5').checked == true )
			){
				q_two_progress = 20;
			}else{
				q_two_progress = 0;
			}
			
			total_progress = q_one_progress + q_two_progress +q_three_progress +q_four_progress +q_five_progress;
			
			$("#progress").attr("style", "width:"+total_progress+"%")
			
			
		}, 100);		

		
		$("#finish_btn").click(function(){

			var results = {
				question_one: $("#question_one").val(),
				tech_one: $("#tech1").val(),
				tech_two: $("#tech2").val(),
				tech_three: $("#tech3").val(),				
				tech_fourth: $("#tech4").val(),
				tech_five: $("#tech5").val(),
				question_three: $("#question_three").val(),
				question_fourth: $("#question_fourth").val(),
				question_five: $("#question_five").val()
			}

			if(
				(results.question_one != "")&&
				(results.question_three != "")&&
				(results.question_fourth != "")&&
				(results.question_five != "")&&
				(
					(document.getElementById('tech1').checked == true )||
					(document.getElementById('tech2').checked == true )||
					(document.getElementById('tech3').checked == true )||
					(document.getElementById('tech4').checked == true )||
					(document.getElementById('tech5').checked == true )
				)
			){
				
			

			
				$("#quiz").hide();
				
				
				$("#results").show();
				$("#restaurants").show();
				
				$("#result1").html(results.question_one);
	
				if(document.getElementById('tech1').checked){
					$("#tech1_answer").append("<span style='color:green'> Correct!</span>");
				}
				if(document.getElementById('tech2').checked){
					$("#tech2_answer").append("<span style='color:red'> Wrong!</span>");
				}
				if(document.getElementById('tech3').checked){
					$("#tech3_answer").append("<span style='color:green'> Correct!</span>");
				}						
				if(document.getElementById('tech4').checked){
					$("#tech4_answer").append("<span style='color:red'> Wrong!</span>");
				}			
				if(document.getElementById('tech5').checked){
					$("#tech5_answer").append("<span style='color:green'> Wrong!</span>");
				}			
				
				function palindrome(str) {
				  var re = /[\W_]/g;
				  var lowRegStr = str.toLowerCase().replace(re, '');
				  var reverseStr = lowRegStr.split('').reverse().join(''); 
				  return reverseStr === lowRegStr;
				}
				
				var pali = palindrome(results.question_three);
	
				if(pali == true){
					$("#result3").html(results.question_three + " is a <span style='color:green'> correct</span> palindrome !");
				}else{
					$("#result3").html(results.question_three + " is a <span style='color:red'> wrong</span> palindrome !");
				}
	
				function ReverseString(str) { 
				  
				    // Check input 
				    if(!str || str.length < 2 ||  
				            typeof str!== 'string') { 
				        return 'Not valid';  
				    } 
				      
				    // Take empty array revArray 
				    const revArray = []; 
				    const length = str.length - 1; 
				      
				    // Looping from the end 
				    for(let i = length; i >= 0; i--) { 
				        revArray.push(str[i]); 
				    } 
				      
				    // Joining the array elements 
				    return revArray.join(''); 
				} 			
				
				$("#result4").html(results.question_fourth);
				$("#result5").html(results.question_five);
				
				var reverse_string = ReverseString(results.question_fourth);
				
				if(reverse_string == results.question_five){
					$("#sentence_result").html("<span style='color:green'>Correct reverse sentece!</span> ");
				}else{
					$("#sentence_result").html("<span style='color:red'>Wrong reverse sentece!</span> ");
				}			
			
			}else{
				alert("Please check your answers and complete the quiz");
			}
		});
		


		function createCard(establishment){
			
			var card = "";
			
			card+='<div class="card">';
			card+='	<div class="row">';
			card+='		<div class="col-sm-4 no-margin" >';
			
			console.log("pepe pecas" + JSON.stringify(establishment));
			
			if(establishment.featured_image !== ""){
				card+='			<img class="img-fluid card-img" src="'+establishment.featured_image+'"/>';
			}else{
				card+='			<img class="img-fluid card-img" src="https://cdn.kiwilimon.com/recetaimagen/34016/39654.jpg"/>';				
			}
			
			
			
			card+='		</div>';							
			card+='		<div class="col-sm-8 no-margin">';
			card+='			<div class="col-sm-9">';
			card+='				<h1 class="card-title">'+establishment.name+'</h1>';
			card+='				<div class="subtitle">';
			card+='					<span class="subtitle1">'+establishment.location.city+'</span>';
			card+='					<span class="subtitle2"> <i class="fas fa-circle"></i> '+establishment.establishment[0]+'</span>';
			card+='				</div>';
			card+='			</div>'
			card+='			<div class="details">';
			card+='				<span class="schedule">Open Now </span> <i class="fas fa-circle"></i>';
			card+='				<span class="type">'+establishment.cuisines+'</span> <i class="fas fa-circle"></i>';
			card+='				<span class="cost">Costs $'+establishment.average_cost_for_two+' for two</span>';
			card+='			</div>';
			card+='		</div>';
			card+='	</div>';		

			
			if(establishment.user_rating.aggregate_rating !== 0){
				card+='	<div class="rating">';
				card+='		<span class="rating_no">'+establishment.user_rating.aggregate_rating+'</span><span class="rating-total">/5</span>';
				card+='	</div>';
				card+='	<div class="votes">';
				card+='		<span class="">'+establishment.user_rating.votes+' votes</span>';
				card+='	</div>';												
				card+='</div>';								
			}			
			
			$("#restaurants").append(card);
			
		}
		
	
		//Api Key		fb4980e39edcce855d278c21487b00ab
		
		//San diego is 302

		var san_diego_places = [];
		$.ajax({
		    type: 'POST',
		    url: "https://developers.zomato.com/api/v2.1/establishments?city_id=302",
		    headers: {
		        "user-key":"94d9341d1ab7cac770402e6ff98a36a0"
		    }
		}).done(function(data) { 
			san_diego_places = data;
			
			var total_places = san_diego_places.establishments.length;

			for(var i=0; i<total_places; i++){
				$.ajax({
				    type: 'POST',
				    url: "https://developers.zomato.com/api/v2.1/restaurant?res_id=" + san_diego_places.establishments[i].establishment.id,
				    headers: {
				        "user-key":"94d9341d1ab7cac770402e6ff98a36a0"
				    },
				    statusCode: {
				        404: function() {
				          console.log("page not found");
				        }
				    },				    
					success:function(establisment_data) {						
						
						createCard(establisment_data);	
												
					},
					error:function (xhr, ajaxOptions, thrownError){
					    if(xhr.status==404) {
					        console.log(thrownError);
					    }
					}    
				})
			}
			
		});

		

		
	</script>
	
</html>	


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  